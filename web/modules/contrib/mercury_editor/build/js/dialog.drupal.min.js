!function(){"use strict";!function(t,e,o){function n(e,o,n,i){if("undefined"==typeof DrupalDialogEvent)t(window).trigger(`dialog:${e}`,[o,t(n),i]);else{const t=new DrupalDialogEvent(e,o,i||{});n.dispatchEvent(t)}}function i(t,e){const o=window.getComputedStyle(t.closest("mercury-dialog").shadowRoot.querySelector("dialog")),n=window.getComputedStyle(t.closest("mercury-dialog").shadowRoot.querySelector("main"));e.style.maxWidth=`calc(${o.getPropertyValue("max-width")} - ${n.getPropertyValue("padding-left")} - ${n.getPropertyValue("padding-right")} - 2px)`}e.mercuryDialog=function(i,r){var a,d=t(i);d.dialog=()=>d;var c={open:!1,returnValue:undefined};const l=new ResizeObserver((function(t){for(const e of t){const t=e.target,o=t.getAttribute("data-dock");if(!t.open||!o||"none"==o)return;const n=new CustomEvent("mercury:dockResize",{detail:{width:e.contentRect.width,height:e.contentRect.height},bubbles:!0});a.setAttribute("width",e.contentRect.width),a.dispatchEvent(n)}}));const s=new MutationObserver((function(t){l.observe(a.shadowRoot.querySelector("dialog"))}));function u(t){return void 0!==t&&/^\d+$/.test(t)?`${t}px`:t}function g(e){const o=a.querySelector(".me-dialog__buttonpane");o&&o.remove();const n=document.createElement("div");n.setAttribute("slot","footer"),n.classList.add("me-dialog__buttonpane"),a.appendChild(n),t.isEmptyObject(e)||Array.isArray(e)&&!e.length||e.forEach((t=>{const e=document.createElement("button");e.classList=t.class,e.classList.add("button"),e.appendChild(document.createTextNode(t.text)),e.addEventListener("click",t.click),n.appendChild(e)}))}function h(o){if("MERCURY-DIALOG"!==i.tagName){const e=t("<mercury-dialog>").append(d).appendTo(function(){var e=r.appendTo;return e&&(e.jquery||e.nodeType)?t(e):t(document).find(e||"body").eq(0)}());a=e[0]}else a=i;!function(o,n){if(["title","modal","dock","push","resizable","moveable"].forEach((t=>{void 0!==n[t]&&o.setAttribute(t,n[t])})),n.dialogClass&&o.classList.add(...n.dialogClass.split(" ")),"me-edit-screen"===o.id){let t="true"===localStorage.getItem("mercury-dialog-dock-collapsed"),e=localStorage.getItem("mercury-dialog-dock-width"),i=localStorage.getItem("mercury-dialog-dock-height");if(t)o.setAttribute("width","10"),document.documentElement.style.setProperty("--me-dialog-dock-width","10px");else{let t=e||n.width,r=i||n.height;t&&(o.setAttribute("width",t),document.documentElement.style.setProperty("--me-dialog-dock-width",u(t))),r&&(o.setAttribute("height",r),document.documentElement.style.setProperty("--me-dialog-dock-height",u(r)))}}else n.width&&(o.setAttribute("width",n.width),document.documentElement.style.setProperty("--me-dialog-width",u(n.width))),n.height&&(o.setAttribute("height",n.height),document.documentElement.style.setProperty("--me-dialog-height",u(n.height)));n.drupalAutoButtons&&!n.buttons&&(n.buttons=e.behaviors.mercuryDialog.prepareDialogButtons(t(o))),n.buttons&&n.buttons.length&&g(n.buttons)}(a,o)}function m(t){t={...o.dialog,...o.mercuryEditor,...r,...t},n("beforecreate",c,d.get(0),t),h(t),a[t.modal?"showModal":"show"]();const e=t.autoResize;t.autoResize=!1,n("aftercreate",c,d.get(0),t),t.autoResize=e,s.observe(a,{childList:!0,attributes:!0}),a.addEventListener("close",(function(){p()}))}function p(t){n("beforeclose",c,d.get(0)),l.disconnect(),s.disconnect(),e.detachBehaviors(i,null,"unload"),i.close(),c.returnValue=t,n("afterclose",c,d.get(0)),d.remove()}return c.show=function(){m({modal:!1})},c.showModal=function(){m({modal:!0})},c.applyOptions=function(t){h(t)},c.close=p,c},e.behaviors.mercuryDialog={attach:function(e,o){t("#drupal-mercury-dialog").length||t('<mercury-dialog id="drupal-mercury-dialog"></mercury-dialog>').appendTo("body");const n=t(e).closest("mercury-dialog");n.length&&n.trigger("dialogButtonsChange")},prepareDialogButtons:function(e){var o=[];return e.find(".form-actions").last().find("input[type=submit], a.button, a.action-link").each((function(){var e=t(this).css({display:"none"});o.push({text:e.html()||e.attr("value"),class:e.attr("class"),click:function(t){e.is("a")?e[0].click():(e.trigger("mousedown").trigger("mouseup").trigger("click"),t.preventDefault())}})})),o}},t(window).on("dialog:aftercreate",(function(t,o,n){if("MERCURY-DIALOG"===n[0].tagName&&0===n.attr("id").indexOf("lpb-dialog-")){const t=e.behaviors.mercuryDialog.prepareDialogButtons(n);t.length&&e.mercuryDialog(n[0]).applyOptions({buttons:t})}})),t(window).on("dialog:aftercreate",(function(t,e,o){if("MERCURY-DIALOG"!==o[0].tagName)return;const n=o[0].querySelector("iframe");if(!n)return;o[0].style.setProperty("--me-dialog-height-default","fit-content"),n.onload=function(){!function(t){const e=t.contentWindow.document.body;e.style.width="max-content",e.style.height="fit-content",i(t,e),new ResizeObserver(function(t){return e=>{t&&e.length&&(t.style.height=`${e[0].borderBoxSize[0].blockSize+1}px`,t.style.width=`${e[0].borderBoxSize[0].inlineSize+1}px`)}}(t)).observe(e,{box:"border-box"})}(n),i(n,r)};const r=n?.contentWindow?.document?.body;r&&window.addEventListener("resize",(function(){i(n,r)}))}));const r=[];t(window).on("dialog:aftercreate",(function(t,e,o){"MERCURY-DIALOG"===o[0].tagName&&o[0].hasAttribute("modal")&&"false"!==o[0].getAttribute("modal")&&r.push(o)})),t(window).on("dialog:beforeclose",(function(t,e,o){if("MERCURY-DIALOG"===o[0].tagName&&o[0].hasAttribute("modal")&&"false"!==o[0].getAttribute("modal")){const t=r.indexOf(o);t>-1&&r.splice(t,1)}})),t(window).on("dialog:aftercreate",(function(t,e,o){if("MERCURY-DIALOG"===o[0].tagName&&r.length>0){const t=o.parent(".ui-dialog"),e=t.next(".ui-widget-overlay");r.slice(-1)[0].append([t,e])}}))}(jQuery,Drupal,drupalSettings)}();
