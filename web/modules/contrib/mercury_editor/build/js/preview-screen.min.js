!function(){"use strict";((e,t,n,o)=>{function i(e){const n=t.mercuryEditor?.id||null;if(!n)return e;const o=new URL(e,window.location.origin);return o.origin!==window.location.origin?e:(o.searchParams.set("me_id",n),o.toString())}const s=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(e,t,n,o,a){return s.call(this,e,i(t),n,o,a)};const a=window.fetch;function r(e){return e.stopPropagation(),e.preventDefault(),!1}function d(e){window.parent.postMessage({type:"ajaxPreviewPageState",settings:t.ajaxPageState}),document.querySelectorAll(".is-me-focused").forEach((e=>{e.classList.remove("is-me-focused")})),e.currentTarget.classList.add("is-me-focused");const n={type:"drupalAjax",settings:{dialogType:e.currentTarget.getAttribute("data-dialog-type"),dialog:JSON.parse(e.currentTarget.getAttribute("data-dialog-options")),dialogRenderer:JSON.parse(e.currentTarget.getAttribute("data-dialog-renderer")),url:i(e.currentTarget.getAttribute("href"))}};return window.parent.postMessage(n),e.stopPropagation(),e.preventDefault(),!1}function l(e){const t=document.querySelector(".gu-mirror");if(!t)return;const n=t.offsetWidth>t.offsetHeight?"offsetHeight":"offsetWidth",o=Math.min(300/t[n],1),i=t.getBoundingClientRect(),s=e.clientX-i.x,a=e.clientY-i.y;t.style.setProperty("transform-origin",`${s}px ${a}px`),t.style.setProperty("transform",`scale(${o})`),window.removeEventListener("mousemove",l)}function c(e){const t=e.target.closest(".lpb-controls, .js-lpb-component");t.classList.add("focused"),t.classList.remove("transitioning"),t.classList.remove("blurred")}function u(e){const t=e.target.closest(".lpb-controls, .js-lpb-component");t.classList.add("transitioning"),setTimeout((()=>{t.classList.contains("transitioning")&&(t.classList.remove("focused"),t.classList.remove("transitioning"),t.classList.add("blurred"))}),250)}window.fetch=function(e,t){let n="string"==typeof e?e:e.url;return n&&(n=i(n)),a(n||e,t)},n(document).on("lpb-builder:init",(e=>{const t=e.target,o=n(t).data("drake");o&&function(e,t){let o,i;const s=n('<div class="lp-hint hidden"></div>')[0];t.on("cloned",((e,t,n)=>{window.addEventListener("mousemove",l)})),t.on("drag",(t=>{t.parentNode&&t.parentNode.insertBefore(s,t),e.find(".js-lpb-ui").addClass("hidden")})),t.on("shadow",((e,t,n)=>{if(e.classList.contains("lp-hint"))return;s.style={width:"",height:"",marginLeft:"",marginTop:""};const i=e.nextElementSibling||e.previousElementSibling,a=i&&e.getBoundingClientRect().top===i.getBoundingClientRect().top?"vertical":"horizontal";if("horizontal"==a){const t=parseInt(window.getComputedStyle(e.parentNode).getPropertyValue("padding-left"));s.style.marginLeft="-"+t+"px"}if("vertical"==a){const t=parseInt(window.getComputedStyle(e.parentNode).getPropertyValue("padding-top"));s.style.marginTop="-"+t+"px"}"vertical"===a&&(s.style.height=e.parentNode.clientHeight+"px"),"horizontal"===a&&(s.style.width=e.parentNode.clientWidth+"px"),s.setAttribute("data-orientation",a),[...t.childNodes].filter((e=>void 0===e.classList)).forEach((e=>e.remove())),t.replaceChild(s,e),null===s.nextSibling&&null!==s.previousSibling&&s.previousSibling.classList.contains("lpb-btn--add")&&t.insertBefore(s,s.previousSibling);const r=null!==s.nextSibling&&s.nextSibling.classList.contains("lp-ghost"),d=null!==s.previousSibling&&s.previousSibling.classList.contains("lp-ghost");r||d?(s.classList.add("hidden"),o.classList.remove("gu-transit")):(s.classList.remove("hidden"),o.classList.add("gu-transit"))})),t.on("cloned",((e,t)=>{o=t.cloneNode(!0),o.classList.add("lp-ghost"),t.parentNode&&t.parentNode.insertBefore(o,t),i=t,t.remove()})),t.on("dragend",(t=>{s.replaceWith(i),o.remove(),e.find(".js-lpb-ui").removeClass("hidden"),e[0].querySelectorAll(".lpb-btn--add.center").forEach((e=>{const t=e.closest(".js-lpb-region");t?.querySelector(".js-lpb-component")?e.style.display="none":e.style.display="block"}))}))}(n(t),o)})),e.behaviors.mercuryEditorPreviewScreen={attach:function(e,i){const s=[...document.querySelectorAll("[data-me-edit-screen-key]")].map((e=>e.getAttribute("data-me-edit-screen-key"))).filter(((e,t,n)=>n.indexOf(e)!==t));s.length>0&&console.error('Multiple HTML elements found using the same data attribute, "data-me-edit-screen-key", which should be unique. Make sure attributes are not passed to child elements in twig templates.',s),window.parent.postMessage({type:"ajaxPreviewPageState",settings:t.ajaxPageState}),o("me-msg-broadcaster",".js-lpb-ui.use-ajax, .js-lpb-ui .use-ajax").forEach((e=>{n(e).off(),e.addEventListener("mousedown",r),e.addEventListener("mouseup",r),e.addEventListener("click",d)})),window.parent!==window&&(o("me-stop-iframed-links","a",e).forEach((e=>{null===e.closest(".lpb-controls")?(e.setAttribute("target","_parent"),e.addEventListener("click",(e=>(e.stopPropagation(),e.preventDefault(),!1)))):e.addEventListener("mousedown",(e=>e.target.focus()))})),o("me-prevent-focus","a, button, input, textarea, select, details",e).forEach((e=>{null!==e.closest(".lpb-controls")||null!==e.closest(".mercury-editor-ui")||e.classList.contains("use-postmessage")||e.setAttribute("tabindex","-1")})),o("me-layout-hover",".lpb-layout").forEach((e=>{e.addEventListener("mouseenter",(e=>{e.target.setAttribute("data-mouseover","true"),setTimeout((()=>{e.target.getAttribute("data-mouseover")&&function(e){[...e.querySelectorAll("[data-region]"),e].forEach((e=>{const n=getComputedStyle(e);e.hasAttribute("data-me-padding")||e.setAttribute("data-me-padding",`${n.paddingTop} ${n.paddingRight} ${n.paddingBottom} ${n.paddingLeft}`);let o=t.mercuryEditor.rolloverPaddingBlock??10,i=t.mercuryEditor.rolloverPaddingInline??0;e.style.paddingTop=Math.max(o,parseInt(n.paddingTop))+"px",e.style.paddingRight=Math.max(i,parseInt(n.paddingRight))+"px",e.style.paddingBottom=Math.max(o,parseInt(n.paddingBottom))+"px",e.style.paddingLeft=Math.max(i,parseInt(n.paddingLeft))+"px"}))}(e.target)}),100)})),e.addEventListener("mouseleave",(e=>{e.target.removeAttribute("data-mouseover"),setTimeout((()=>{e.target.getAttribute("data-mouseover")||function(e){[...e.querySelectorAll("[data-region]"),e].forEach((e=>{e.hasAttribute("data-me-padding")&&(getComputedStyle(e),e.style.padding=e.getAttribute("data-me-padding"))}))}(e.target)}),100)}))}))),o("reveal-on-hover",".js-lpb-component").forEach((e=>{e.addEventListener("mouseenter",c),e.addEventListener("mouseleave",u)})),o("reveal-on-hover",".lpb-controls").forEach((e=>{e.addEventListener("mouseenter",c),e.addEventListener("focusin",c),e.addEventListener("mouseleave",u),e.addEventListener("focusout",u)}))}}})(Drupal,drupalSettings,jQuery,once)}();
